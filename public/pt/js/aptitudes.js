"use strict";$(".w-header").load("./compontents/header.html"),$(".w-footer").load("./compontents/footer.html"),$(".w-cont-header").load("./compontents/firstFoot.html",function(){$(".mark .mark-item dt").removeClass("avtive-dt"),$(".mark .mark-item dd").removeClass("avtive-dd"),$(".itemOne,.itemTwo,.itemThree").find("dt").addClass("avtive-dt"),$(".itemOne,.itemTwo,.itemThree").find("dd").addClass("avtive-dd")});var token=sessionStorage.getItem("token"),enterType=sessionStorage.getItem("enterType"),sendParamObj=JSON.parse(sessionStorage.getItem("sendParamObj")),loginInfo=JSON.parse(sessionStorage.getItem("loginInfo")),isEditStatus=sessionStorage.getItem("isEditStatus");function paperTypeFn(e,a){$("#paperText").text($(e).text()),$("input[name=paper_type]").val(a)}function cardTypeFn(e,a){$("#cardText").text($(e).text()),$("input[name=card_type]").val(a)}function yyFilesChange(){var e=new FormData;e.append("file",$("#yyFiles")[0].files[0]),e.append("token",token);var n=layer.load();uplaodImg("/store_v1/index/uploadFile",e,function(e){if(layer.close(n),1==e.status){var a='<div class="uploaded-img-item">\n          <img src="'+base+e.data.src+'" alt="" class="up-img">\n          <input type="hidden" name="license_img" value="'+e.data.src+'"/>\n          <div class="model-delImg">\n              <img src="./images/delImg.png" onclick="removeLicenseImg(this)">\n          </div>\n      </div>';$("#yyImgUl").append(a),2<=$("#yyImgUl>.uploaded-img-item").length?$("#addYyIcon").hide():$("#addYyIcon").show()}else layer.msg(e.msg)},function(e){layer.close(n)})}function removeLicenseImg(e){$(e).parents(".uploaded-img-item").remove(),$("#addYyIcon").show()}function cardFilesChange(){var e=new FormData;e.append("file",$("#cardFiles")[0].files[0]),e.append("token",token);var n=layer.load();uplaodImg("/store_v1/index/uploadFile",e,function(e){if(layer.close(n),1==e.status){var a='<div class="uploaded-img-item">\n          <img src="'+base+e.data.src+'" alt="" class="up-img">\n          <input type="hidden" name="card_img" value="'+e.data.src+'"/>\n          <div class="model-delImg">\n              <img src="./images/delImg.png" onclick="removeCardImg(this)">\n          </div>\n      </div>';$("#cardImgUl").append(a),2<=$("#cardImgUl>.uploaded-img-item").length?$("#addCardImg").hide():$("#addCardImg").show()}else layer.msg(e.msg)},function(e){layer.close(n)})}function removeCardImg(e){$(e).parents(".uploaded-img-item").remove(),$("#addCardImg").show()}function gotoBackStep(){1==enterType?window.location.href="./brandInfo.html":sendParamObj.brand_id?window.location.href="./brandInfo.html":window.location.href="./entityBusiness.html"}function selectHeModeFn(e,a){$(e).parents("li").addClass("active").siblings().removeClass("active"),$("input[name=partner_mode]").val(a)}function gotoFourSubmit(){var e=$("input[name=main_body_type]").val(),a=$("input[name=paper_type]").val(),n=[];if($("#yyImgUl>.uploaded-img-item").each(function(){n.push($(this).find("input[name=license_img]").val())}),n.length<=0)return layer.msg("请上传营业执照电子版"),!1;var t=$("input[name=license_name]").val();if(!t)return layer.msg("请输入营业执照上的名称"),!1;var i=$("input[name=license_no]").val();if(!i)return layer.msg("请输入营业执照注册号"),!1;var s=$("input[name=build_time]").val();if(!s)return layer.msg("请选择成立时间"),!1;var d=$("input[name=open_start_time]").val(),m=$("input[name=open_end_time]").val();if($(".radio-box-time").hasClass("active")){if(!d)return layer.msg("请选择营业时间"),!1;m=0}else{if(!d||!m)return layer.msg("请选择营业时间"),!1;var r=new Date(d).getTime();if(new Date(m).getTime()-r<=0)return layer.msg("有效期结束时间必须大于开始时间"),!1}var o=$("input[name=card_type]").val(),l=[];if($("#cardImgUl>.uploaded-img-item").each(function(){l.push($(this).find("input[name=card_img]").val())}),l.length<=0)return layer.msg("请上传经营者证件电子版"),!1;2==enterType&&(sendParamObj.partner_mode=$("input[name=partner_mode]").val()),isEditStatus&&(sendParamObj.store_id=loginInfo.store_id),sendParamObj.main_body_type=e,sendParamObj.paper_type=a,sendParamObj.license_img=n,sendParamObj.license_name=t,sendParamObj.license_no=i,sendParamObj.build_time=s,sendParamObj.open_start_time=d,sendParamObj.open_end_time=m,sendParamObj.card_type=o,sendParamObj.card_img=l,sendParamObj.type=enterType,sendParamObj.has_brand=sendParamObj.brand_id?1:0,sessionStorage.setItem("sendParamObj",JSON.stringify(sendParamObj));var c=layer.load();sendParamObj.token=token,isEditStatus?(console.log(sendParamObj),ajaxPost("/store_v1/enter/updateInfo",sendParamObj,function(e){layer.close(c),1==e.status?(sessionStorage.clear(),window.location.href="./checkResult.html?type=1"):layer.msg(e.msg)})):ajaxPost("/store_v1/enter/submitInfo",sendParamObj,function(e){layer.close(c),1==e.status?(sessionStorage.clear(),window.location.href="./checkResult.html?type=1"):layer.msg(e.msg)})}$(function(){if(2==enterType&&($("#partnerModeBox").show(),$(".show-ruzhu-phone").show()),$(".jcDate").jcDate({IcoClass:"jcDateIco",Event:"click",Speed:100,Left:0,Top:28,format:"-",Timeout:100}),$("input").placeholder(),$(".radio-box").click(function(){var e=parseInt($(".radio-box").index(this));$(this).addClass("active").siblings().removeClass("active"),$("input[name=main_body_type]").val(0==e?1:2)}),$(".radio-box-time").click(function(){$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")}),sendParamObj.license_name){var e=1==sendParamObj.main_body_type?0:1;$(".radio-box").eq(e).addClass("active").siblings().removeClass("active"),$("input[name=main_body_type]").val(sendParamObj.main_body_type);var a=1==sendParamObj.paper_type?"普通营业执照":"多证合一营业执照（统一社会信用代码）";$("#paperText").text(a),$("input[name=paper_type]").val(sendParamObj.paper_type);var n="";if(0<sendParamObj.license_img.length)for(var t=0;t<sendParamObj.license_img.length;t++)n+='<div class="uploaded-img-item">\n          <img src="'+base+sendParamObj.license_img[t]+'" alt="" class="up-img">\n          <input type="hidden" name="license_img" value="'+sendParamObj.license_img[t]+'"/>\n          <div class="model-delImg">\n              <img src="./images/delImg.png" onclick="removeLicenseImg(this)">\n          </div>\n      </div>';$("#yyImgUl").html(n),2<=sendParamObj.license_img.length?$("#addYyIcon").hide():$("#addYyIcon").show(),$("input[name=license_name]").val(sendParamObj.license_name),$("input[name=license_no]").val(sendParamObj.license_no),$("input[name=build_time]").val(sendParamObj.build_time),$("input[name=open_start_time]").val(sendParamObj.open_start_time),0==sendParamObj.open_end_time?($(".radio-box-time").addClass("active"),$("input[name=open_end_time]").val("")):($(".radio-box-time").removeClass("active"),$("input[name=open_end_time]").val(sendParamObj.open_end_time));var i=1==sendParamObj.card_type?"大陆居民身份证":"护照";$("#cardText").text(i),$("input[name=card_type]").val(sendParamObj.card_type);var s="";if(0<sendParamObj.card_img.length)for(t=0;t<sendParamObj.card_img.length;t++)s+='<div class="uploaded-img-item">\n          <img src="'+base+sendParamObj.card_img[t]+'" alt="" class="up-img">\n          <input type="hidden" name="card_img" value="'+sendParamObj.card_img[t]+'"/>\n          <div class="model-delImg">\n              <img src="./images/delImg.png" onclick="removeCardImg(this)">\n          </div>\n      </div>';if($("#cardImgUl").html(s),2<=sendParamObj.card_img.length?$("#addCardImg").hide():$("#addCardImg").show(),sendParamObj.partner_mode){var d=1==sendParamObj.partner_mode?0:1;$(".mode-ul>li").eq(d).addClass("active").siblings().removeClass("active"),$("input[name=partner_mode]").val(sendParamObj.partner_mode)}}});